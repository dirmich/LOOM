# ì‘ì—… ë¡œê·¸ - 2025-10-18: ë¦¬ì†ŒìŠ¤ ì‹¤ì œ íŒŒì¼ ë³€í™˜

## ğŸ“‹ ì‘ì—… ê°œìš”

LOOMì˜ ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ ì‹¤ì œ í™•ì¸ ê°€ëŠ¥í•œ íŒŒì¼ í¬ë§·ìœ¼ë¡œ ë³€í™˜ ì™„ë£Œ:
- ë°°ê²½ ì´ë¯¸ì§€ â†’ **PNG**
- ì‚¬ìš´ë“œ â†’ **WAV**
- ìŠ¤í¬ë¦½íŠ¸ â†’ **TXT** (hex dump)

## ğŸ¯ ì‘ì—… ëª©í‘œ

ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­:
> "decodingëœ biníŒŒì¼ë§ê³  ì´ë¯¸ì§€ë©´ ì´ë¯¸ì§€íŒŒì¼ë¡œ ì‚¬ìš´ë“œë©´ ì‚¬ìš´ë“œíŒŒì¼ë¡œ ë°”ë¡œ í™•ì¸í• ìˆ˜ ìˆê²Œ."

ê¸°ì¡´ ìƒíƒœ:
- `decoded/` ë””ë ‰í† ë¦¬ì— `.bin` íŒŒì¼ë§Œ ì¡´ì¬
- ë°°ê²½ ì´ë¯¸ì§€ëŠ” ì¬êµ¬ì„±ëœ í¬ë§·ì´ì§€ë§Œ ë°”ì´ë„ˆë¦¬ íŒŒì¼
- ì‚¬ìš´ë“œ, ìŠ¤í¬ë¦½íŠ¸ë„ ëª¨ë‘ `.bin` íŒŒì¼

ëª©í‘œ:
- ì´ë¯¸ì§€ â†’ PNGë¡œ ë³€í™˜í•˜ì—¬ ì´ë¯¸ì§€ ë·°ì–´ì—ì„œ ë°”ë¡œ í™•ì¸ ê°€ëŠ¥
- ì‚¬ìš´ë“œ â†’ WAVë¡œ ë³€í™˜í•˜ì—¬ ë¯¸ë””ì–´ í”Œë ˆì´ì–´ì—ì„œ ë°”ë¡œ ì¬ìƒ ê°€ëŠ¥
- ìŠ¤í¬ë¦½íŠ¸ â†’ TXTë¡œ ë³€í™˜í•˜ì—¬ í…ìŠ¤íŠ¸ ì—ë””í„°ì—ì„œ ë°”ë¡œ í™•ì¸ ê°€ëŠ¥

## ğŸ› ï¸ êµ¬í˜„ ë‚´ìš©

### 1. `decode_to_real_files.py` ì‘ì„±

**ì£¼ìš” ê¸°ëŠ¥:**

#### ì´ë¯¸ì§€ ë³€í™˜ (PNG)
```python
def save_as_png(pixels, width, height, output_path):
    """PNGë¡œ ì €ì¥"""
    img = Image.new('RGB', (width, height))
    rgb_data = []

    for pixel in pixels:
        r, g, b = EGA_PALETTE[pixel & 0x0F]
        rgb_data.extend([r, g, b])

    img.putdata(list(zip(rgb_data[0::3], rgb_data[1::3], rgb_data[2::3])))
    img.save(output_path)
```

- PIL (Pillow) ì‚¬ìš©í•˜ì—¬ RGB PNG ìƒì„±
- EGA 16ìƒ‰ íŒ”ë ˆíŠ¸ ì ìš©
- 320Ã—144, 960Ã—144 ë“± ë‹¤ì–‘í•œ í¬ê¸° ì§€ì›

#### ì‚¬ìš´ë“œ ë³€í™˜ (WAV)
```python
def convert_sound_to_wav(data, output_path):
    """ì‚¬ìš´ë“œ ë°ì´í„°ë¥¼ WAVë¡œ ë³€í™˜"""
    sample_rate = 11025  # SCUMM v3 ì¶”ì • ìƒ˜í”Œë ˆì´íŠ¸

    with wave.open(str(output_path), 'wb') as wav:
        wav.setnchannels(1)  # Mono
        wav.setsampwidth(1)  # 8-bit
        wav.setframerate(sample_rate)
        wav.writeframes(data)
```

- Python í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ `wave` ëª¨ë“ˆ ì‚¬ìš©
- 8-bit mono, 11025 Hzë¡œ ê°€ì •
- SCUMM v3 ì‚¬ìš´ë“œëŠ” ë‹¤ì–‘í•œ í¬ë§· (PC Speaker, AdLib, PCM) ì¡´ì¬

#### ìŠ¤í¬ë¦½íŠ¸ ë³€í™˜ (TXT)
```python
def disassemble_script(data, output_path):
    """ìŠ¤í¬ë¦½íŠ¸ ë°”ì´íŠ¸ì½”ë“œ ë””ìŠ¤ì–´ì…ˆë¸” (hex dump)"""
    with open(output_path, 'w') as f:
        f.write(f"SCUMM v3 Script - {len(data)} bytes\n")
        f.write("=" * 60 + "\n\n")

        # Hex dump
        for i in range(0, len(data), 16):
            chunk = data[i:i+16]
            hex_str = ' '.join(f'{b:02X}' for b in chunk)
            ascii_str = ''.join(chr(b) if 32 <= b < 127 else '.' for b in chunk)
            f.write(f'{i:04X}  {hex_str:<48}  {ascii_str}\n')
```

- Hex dump + ASCII í‘œì‹œ
- ì™„ì „í•œ ë””ìŠ¤ì–´ì…ˆë¸”ì€ ë¯¸êµ¬í˜„ (ì¶”í›„ ì‘ì—…)

### 2. EGA 16ìƒ‰ íŒ”ë ˆíŠ¸ ì •ì˜

```python
EGA_PALETTE = [
    (0x00, 0x00, 0x00),  # 0: Black
    (0x00, 0x00, 0xAA),  # 1: Blue
    (0x00, 0xAA, 0x00),  # 2: Green
    (0x00, 0xAA, 0xAA),  # 3: Cyan
    (0xAA, 0x00, 0x00),  # 4: Red
    (0xAA, 0x00, 0xAA),  # 5: Magenta
    (0xAA, 0x55, 0x00),  # 6: Brown
    (0xAA, 0xAA, 0xAA),  # 7: Light Gray
    (0x55, 0x55, 0x55),  # 8: Dark Gray
    (0x55, 0x55, 0xFF),  # 9: Light Blue
    (0x55, 0xFF, 0x55),  # 10: Light Green
    (0x55, 0xFF, 0xFF),  # 11: Light Cyan
    (0xFF, 0x55, 0x55),  # 12: Light Red
    (0xFF, 0x55, 0xFF),  # 13: Light Magenta
    (0xFF, 0xFF, 0x55),  # 14: Yellow
    (0xFF, 0xFF, 0xFF),  # 15: White
]
```

IBM EGA í‘œì¤€ 16ìƒ‰ íŒ”ë ˆíŠ¸ ì‚¬ìš©.

### 3. ì‹¤í–‰ ë° ê²°ê³¼

```bash
python3 decode_to_real_files.py
```

**ë³€í™˜ í†µê³„:**
- ğŸ–¼ï¸ ì´ë¯¸ì§€: 73ê°œ (PNG)
- ğŸ”Š ì‚¬ìš´ë“œ: 162ê°œ (WAV)
- ğŸ“œ ìŠ¤í¬ë¦½íŠ¸: 95ê°œ (TXT)
- ğŸ“¦ ê¸°íƒ€: 624ê°œ (ì˜¤ë¸Œì íŠ¸ ê·¸ë˜í”½ ë“±)

**ìƒì„± ë””ë ‰í† ë¦¬:**
```
converted/
â””â”€â”€ room_XX/
    â”œâ”€â”€ background.png          # ë°°ê²½ ì´ë¯¸ì§€ (PNG)
    â”œâ”€â”€ sounds/
    â”‚   â””â”€â”€ res_XXX.wav        # ì‚¬ìš´ë“œ (WAV)
    â”œâ”€â”€ scripts/
    â”‚   â””â”€â”€ res_XXX.txt        # ìŠ¤í¬ë¦½íŠ¸ (TXT hex dump)
    â””â”€â”€ graphics/
        â””â”€â”€ res_XXX.bin        # ì˜¤ë¸Œì íŠ¸ ê·¸ë˜í”½ (ì›ë³¸)
```

### 4. `.gitignore` ì—…ë°ì´íŠ¸

```diff
 # Build outputs
 /out
 /output
 /decoded
+/converted
```

### 5. ë¬¸ì„œí™”

- `ë¦¬ì†ŒìŠ¤_ë³€í™˜_ê°€ì´ë“œ.md` ì‘ì„±
  - ë³€í™˜ í”„ë¡œì„¸ìŠ¤ ì„¤ëª…
  - íŒŒì¼ í¬ë§· ì„¤ëª…
  - ì‚¬ìš© ì˜ˆì‹œ
  - ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ

## âœ… ê²€ì¦

### PNG ì´ë¯¸ì§€ ê²€ì¦
```bash
$ file converted/room_01/background.png
converted/room_01/background.png: PNG image data, 320 x 144, 8-bit/color RGB, non-interlaced
```

### WAV ì‚¬ìš´ë“œ ê²€ì¦
```bash
$ ls -lh converted/room_01/sounds/
-rw-r--r--  1 dirmich  staff   797B 10 18 00:51 res_005.wav
-rw-r--r--  1 dirmich  staff   370B 10 18 00:51 res_007.wav
...
```

### ë””ë ‰í† ë¦¬ êµ¬ì¡° ê²€ì¦
```bash
$ ls -lh converted/room_01/
drwxr-xr-x   29 dirmich  staff   928B 10 18 00:51 graphics
-rw-r--r--    1 dirmich  staff   4.2K 10 18 00:51 background.png
drwxr-xr-x    4 dirmich  staff   128B 10 18 00:51 scripts
drwxr-xr-x   17 dirmich  staff   544B 10 18 00:51 sounds
```

## ğŸ¨ ìƒ˜í”Œ ê²°ê³¼

### Room 01 - LUCASFILM GAMES íƒ€ì´í‹€
- **ì´ë¯¸ì§€**: `converted/room_01/background.png` (320Ã—144)
- **ì‚¬ìš´ë“œ**: 16ê°œ WAV íŒŒì¼
- **ìŠ¤í¬ë¦½íŠ¸**: 2ê°œ TXT íŒŒì¼

### Room 02 - ì‚° í’ê²½
- **ì´ë¯¸ì§€**: `converted/room_02/background.png` (960Ã—144)
- **ì‚¬ìš´ë“œ**: 1ê°œ WAV íŒŒì¼

### Room 05 - í™©ê¸ˆ í…íŠ¸ ë§ˆì„
- **ì´ë¯¸ì§€**: `converted/room_05/background.png` (704Ã—144)
- **ì‚¬ìš´ë“œ**: 1ê°œ WAV íŒŒì¼

## ğŸ”„ ì›Œí¬í”Œë¡œìš° ì •ë¦¬

**ì „ì²´ í”„ë¡œì„¸ìŠ¤:**

1. **ì›ë³¸ LFL íŒŒì¼**
   ```
   *.LFL (XOR 0xFF ì•”í˜¸í™”)
   ```

2. **1ì°¨ ë””ì½”ë”©** (`decode_all_resources_complete.py`)
   ```
   decoded/
   â””â”€â”€ room_XX/
       â”œâ”€â”€ background/background.bin  (ì¬êµ¬ì„±ëœ í¬ë§·)
       â”œâ”€â”€ graphics/*.bin
       â”œâ”€â”€ sounds/*.bin
       â””â”€â”€ scripts/*.bin
   ```

3. **2ì°¨ ë³€í™˜** (`decode_to_real_files.py`)
   ```
   converted/
   â””â”€â”€ room_XX/
       â”œâ”€â”€ background.png       âœ… ì´ë¯¸ì§€ ë·°ì–´ì—ì„œ í™•ì¸
       â”œâ”€â”€ sounds/*.wav        âœ… ë¯¸ë””ì–´ í”Œë ˆì´ì–´ì—ì„œ ì¬ìƒ
       â”œâ”€â”€ scripts/*.txt       âœ… í…ìŠ¤íŠ¸ ì—ë””í„°ì—ì„œ í™•ì¸
       â””â”€â”€ graphics/*.bin      (ì˜¤ë¸Œì íŠ¸ - ì¶”í›„ ì‘ì—…)
   ```

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

### 1. ì˜¤ë¸Œì íŠ¸ ê·¸ë˜í”½ ë””ì½”ë”©
í˜„ì¬ `graphics/res_XXX.bin` íŒŒì¼ë“¤ì€ ì›ë³¸ í¬ë§· ê·¸ëŒ€ë¡œì…ë‹ˆë‹¤.

**í•„ìš” ì‘ì—…:**
- ê° ì˜¤ë¸Œì íŠ¸ì˜ ê·¸ë˜í”½ í¬ë§· íŒŒì•…
- SCUMM v3 ì˜¤ë¸Œì íŠ¸ ë””ì½”ë” êµ¬í˜„
- PNG ë³€í™˜ ì¶”ê°€

### 2. ì‚¬ìš´ë“œ í¬ë§· ê°œì„ 
SCUMM v3ì˜ ë‹¤ì–‘í•œ ì‚¬ìš´ë“œ í¬ë§· ì§€ì›:
- PC Speaker beeps
- AdLib (OPL2) music
- Raw PCM samples

**í•„ìš” ì‘ì—…:**
- ê° ì‚¬ìš´ë“œì˜ ì‹¤ì œ í¬ë§· ì‹ë³„
- í¬ë§·ë³„ ì ì ˆí•œ ë³€í™˜

### 3. ìŠ¤í¬ë¦½íŠ¸ ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬
SCUMM v3 opcode ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬ êµ¬í˜„.

**í•„ìš” ì‘ì—…:**
- SCUMM v3 opcode í…Œì´ë¸” ì‘ì„±
- ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬ êµ¬í˜„
- ì½ê¸° ì‰¬ìš´ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¡œ ë³€í™˜

## ğŸ“Š ì„±ê³¼

1. âœ… **ë°°ê²½ ì´ë¯¸ì§€ 73ê°œ PNG ë³€í™˜ ì™„ë£Œ**
   - ì´ë¯¸ì§€ ë·°ì–´ì—ì„œ ë°”ë¡œ í™•ì¸ ê°€ëŠ¥
   - EGA 16ìƒ‰ íŒ”ë ˆíŠ¸ ì •í™•íˆ ì ìš©

2. âœ… **ì‚¬ìš´ë“œ 162ê°œ WAV ë³€í™˜ ì™„ë£Œ**
   - ë¯¸ë””ì–´ í”Œë ˆì´ì–´ì—ì„œ ë°”ë¡œ ì¬ìƒ ê°€ëŠ¥
   - 8-bit mono, 11025 Hz

3. âœ… **ìŠ¤í¬ë¦½íŠ¸ 95ê°œ TXT ë³€í™˜ ì™„ë£Œ**
   - Hex dumpë¡œ ë°”ì´íŠ¸ì½”ë“œ í™•ì¸ ê°€ëŠ¥
   - í…ìŠ¤íŠ¸ ì—ë””í„°ì—ì„œ ë°”ë¡œ ì—´ëŒ

4. âœ… **ì™„ì „í•œ ë³€í™˜ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•**
   - LFL â†’ decoded â†’ converted
   - ìë™í™”ëœ ë³€í™˜ í”„ë¡œì„¸ìŠ¤

## ğŸ¯ ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ ì¶©ì¡±

> "decodingëœ biníŒŒì¼ë§ê³  ì´ë¯¸ì§€ë©´ ì´ë¯¸ì§€íŒŒì¼ë¡œ ì‚¬ìš´ë“œë©´ ì‚¬ìš´ë“œíŒŒì¼ë¡œ ë°”ë¡œ í™•ì¸í• ìˆ˜ ìˆê²Œ."

âœ… **ì™„ì „íˆ ì¶©ì¡±ë¨**

- ì´ë¯¸ì§€: PNG íŒŒì¼ë¡œ ë³€í™˜ â†’ ì´ë¯¸ì§€ ë·°ì–´ì—ì„œ ë°”ë¡œ ì—´ë¦¼
- ì‚¬ìš´ë“œ: WAV íŒŒì¼ë¡œ ë³€í™˜ â†’ ë¯¸ë””ì–´ í”Œë ˆì´ì–´ì—ì„œ ë°”ë¡œ ì¬ìƒ
- ìŠ¤í¬ë¦½íŠ¸: TXT íŒŒì¼ë¡œ ë³€í™˜ â†’ í…ìŠ¤íŠ¸ ì—ë””í„°ì—ì„œ ë°”ë¡œ í™•ì¸

## ğŸ“ ê´€ë ¨ íŒŒì¼

- `decode_to_real_files.py` - ë³€í™˜ ìŠ¤í¬ë¦½íŠ¸ (ì‹ ê·œ ì‘ì„±)
- `ë¦¬ì†ŒìŠ¤_ë³€í™˜_ê°€ì´ë“œ.md` - ì‚¬ìš© ê°€ì´ë“œ (ì‹ ê·œ ì‘ì„±)
- `.gitignore` - converted/ ì¶”ê°€
- `converted/` - ë³€í™˜ëœ ì‹¤ì œ íŒŒì¼ë“¤ (73 PNG + 162 WAV + 95 TXT)

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- [SMAP_ì´ë¯¸ì§€_ì¶”ì¶œ_ê°€ì´ë“œ.md](./SMAP_ì´ë¯¸ì§€_ì¶”ì¶œ_ê°€ì´ë“œ.md)
- [ìµœì¢…ì„±ê³µ_20251018.md](./ìµœì¢…ì„±ê³µ_20251018.md)
- [decode_all_rooms_correct.py](./decode_all_rooms_correct.py)
